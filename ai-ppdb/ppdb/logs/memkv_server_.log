[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:899 memkv_init(): Initializing MemKV service...
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:933 memkv_init(): MemKV service initialized successfully
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/ppdb/ppdb.c:669 parse_memkv_config(): Parsing config line: [127.0.0.1 11211 memkv  file::memory:?cache=shared]
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/ppdb/ppdb.c:729 parse_memkv_config(): Parsed values - host:[127.0.0.1] port:[11211] type:[memkv] backend:[file::memory:?cache=shared]
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/ppdb/ppdb.c:749 parse_memkv_config(): Added memkv service: 127.0.0.1:11211, backend: file::memory:?cache=shared
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:1111 memkv_apply_config(): Applying configuration...
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:1140 memkv_apply_config(): Applied configuration - host: 127.0.0.1, port: 11211, db_path: file::memory:?cache=shared
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:997 memkv_start(): Adding listener on 127.0.0.1:11211
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_poll.c:273 poly_poll_add_listener(): Added listener on 127.0.0.1:11211
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_poll.c:324 poly_poll_start(): New connection from 127.0.0.1:58617 on socket 0
[2025-02-09 14:17:33] WARN /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:828 handle_connection(): Failed to set TCP_KEEPIDLE
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:107 db_init(): Opening database: file::memory:?cache=shared
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: CREATE TABLE IF NOT EXISTS kv_store (  key TEXT PRIMARY KEY,  value BLOB,  flags INTEGER,  expiry INTEGER);CREATE INDEX IF NOT EXISTS idx_expiry ON kv_store(expiry);
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:142 db_init(): Database connection established
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:859 handle_connection(): New client connection from 127.0.0.1:58617
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:600 handle_request(): Client 127.0.0.1:58617 closed connection
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: PRAGMA wal_checkpoint;
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_poll.c:324 poly_poll_start(): New connection from 127.0.0.1:58618 on socket 0
[2025-02-09 14:17:33] WARN /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:828 handle_connection(): Failed to set TCP_KEEPIDLE
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:107 db_init(): Opening database: file::memory:?cache=shared
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: CREATE TABLE IF NOT EXISTS kv_store (  key TEXT PRIMARY KEY,  value BLOB,  flags INTEGER,  expiry INTEGER);CREATE INDEX IF NOT EXISTS idx_expiry ON kv_store(expiry);
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:142 db_init(): Database connection established
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:859 handle_connection(): New client connection from 127.0.0.1:58618
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 63 bytes from 127.0.0.1:58618, total buffer size: 63
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58618: flush_all, key: 0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: DELETE FROM kv_store
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58618: set, key: key1
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58618: get, key: key1
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:153 kv_get(): kv_get for key: [key1]
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:195 kv_get(): Got blob data: size=6
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:275 kv_get(): Successfully got key-value pair: [key1]=[value1], flags=0, exptime=0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 16 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 16 bytes, sent 16 bytes, err=0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 16/16 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 16 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 6 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 6 bytes, sent 6 bytes, err=0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 6/6 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 6 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 2 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 2 bytes, sent 2 bytes, err=0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 2/2 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 2 bytes
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:542 handle_get(): Successfully sent key-value pair: [key1]=[value1]
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 5 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 5 bytes, sent 5 bytes, err=0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 5/5 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 5 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 84 bytes from 127.0.0.1:58618, total buffer size: 84
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58618: flush_all, key: 0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: DELETE FROM kv_store
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58618: set, key: key1
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58618: delete, key: key1
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: BEGIN TRANSACTION
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: COMMIT
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58618: get, key: key1
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:153 kv_get(): kv_get for key: [key1]
[2025-02-09 14:17:33] ERROR /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:190 kv_get(): Failed to get blob data: -11
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 11 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 11 bytes, sent 11 bytes, err=0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 11/11 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 11 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 5 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 5 bytes, sent 5 bytes, err=0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 5/5 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 5 bytes
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:600 handle_request(): Client 127.0.0.1:58618 closed connection
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: PRAGMA wal_checkpoint;
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_poll.c:324 poly_poll_start(): New connection from 127.0.0.1:58619 on socket 0
[2025-02-09 14:17:33] WARN /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:828 handle_connection(): Failed to set TCP_KEEPIDLE
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:107 db_init(): Opening database: file::memory:?cache=shared
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: CREATE TABLE IF NOT EXISTS kv_store (  key TEXT PRIMARY KEY,  value BLOB,  flags INTEGER,  expiry INTEGER);CREATE INDEX IF NOT EXISTS idx_expiry ON kv_store(expiry);
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:142 db_init(): Database connection established
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:859 handle_connection(): New client connection from 127.0.0.1:58619
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 42 bytes from 127.0.0.1:58619, total buffer size: 42
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58619: flush_all, key: 0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: DELETE FROM kv_store
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58619: get, key: nonexistent_key
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:153 kv_get(): kv_get for key: [nonexistent_key]
[2025-02-09 14:17:33] ERROR /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:190 kv_get(): Failed to get blob data: -11
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 11 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 11 bytes, sent 11 bytes, err=0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 11/11 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 11 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 5 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 5 bytes, sent 5 bytes, err=0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 5/5 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 5 bytes
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:600 handle_request(): Client 127.0.0.1:58619 closed connection
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: PRAGMA wal_checkpoint;
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_poll.c:324 poly_poll_start(): New connection from 127.0.0.1:58620 on socket 0
[2025-02-09 14:17:33] WARN /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:828 handle_connection(): Failed to set TCP_KEEPIDLE
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:107 db_init(): Opening database: file::memory:?cache=shared
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: CREATE TABLE IF NOT EXISTS kv_store (  key TEXT PRIMARY KEY,  value BLOB,  flags INTEGER,  expiry INTEGER);CREATE INDEX IF NOT EXISTS idx_expiry ON kv_store(expiry);
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:142 db_init(): Database connection established
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:859 handle_connection(): New client connection from 127.0.0.1:58620
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 63 bytes from 127.0.0.1:58620, total buffer size: 63
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58620: flush_all, key: 0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: DELETE FROM kv_store
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58620: set, key: key1
DEBUG: Setting expiration time: exptime=1, now=1739081853, real_exptime=1739081854
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58620: get, key: key1
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:153 kv_get(): kv_get for key: [key1]
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:195 kv_get(): Got blob data: size=6
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:275 kv_get(): Successfully got key-value pair: [key1]=[value1], flags=0, exptime=0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 16 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 16 bytes, sent 16 bytes, err=0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 16/16 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 16 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 6 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 6 bytes, sent 6 bytes, err=0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 6/6 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 6 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 2 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 2 bytes, sent 2 bytes, err=0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 2/2 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 2 bytes
[2025-02-09 14:17:33] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:542 handle_get(): Successfully sent key-value pair: [key1]=[value1]
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 5 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 5 bytes, sent 5 bytes, err=0
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 5/5 bytes
[2025-02-09 14:17:33] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 5 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 10 bytes from 127.0.0.1:58620, total buffer size: 10
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58620: get, key: key1
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:153 kv_get(): kv_get for key: [key1]
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:195 kv_get(): Got blob data: size=6
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:214 kv_get(): Key expired: [key1], expiry=1739081854, now=1739081855
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 11 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 11 bytes, sent 11 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 11/11 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 11 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 5 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 5 bytes, sent 5 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 5/5 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 5 bytes
[2025-02-09 14:17:35] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:600 handle_request(): Client 127.0.0.1:58620 closed connection
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: PRAGMA wal_checkpoint;
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:35] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_poll.c:324 poly_poll_start(): New connection from 127.0.0.1:58628 on socket 0
[2025-02-09 14:17:35] WARN /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:828 handle_connection(): Failed to set TCP_KEEPIDLE
[2025-02-09 14:17:35] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:107 db_init(): Opening database: file::memory:?cache=shared
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: CREATE TABLE IF NOT EXISTS kv_store (  key TEXT PRIMARY KEY,  value BLOB,  flags INTEGER,  expiry INTEGER);CREATE INDEX IF NOT EXISTS idx_expiry ON kv_store(expiry);
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:35] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:142 db_init(): Database connection established
[2025-02-09 14:17:35] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:859 handle_connection(): New client connection from 127.0.0.1:58628
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 67 bytes from 127.0.0.1:58628, total buffer size: 67
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: flush_all, key: 0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: DELETE FROM kv_store
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: set, key: counter
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: incr, key: counter
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:1231 handle_incr_decr(): Handling INCR command for key='counter', value='1'
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:153 kv_get(): kv_get for key: [counter]
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:195 kv_get(): Got blob data: size=1
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:275 kv_get(): Successfully got key-value pair: [counter]=[0], flags=0, exptime=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 3 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 3 bytes, sent 3 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 3/3 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 3 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 16 bytes from 127.0.0.1:58628, total buffer size: 16
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: incr, key: counter
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:1231 handle_incr_decr(): Handling INCR command for key='counter', value='2'
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:153 kv_get(): kv_get for key: [counter]
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:195 kv_get(): Got blob data: size=1
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:275 kv_get(): Successfully got key-value pair: [counter]=[1], flags=0, exptime=1
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 3 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 3 bytes, sent 3 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 3/3 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 3 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 16 bytes from 127.0.0.1:58628, total buffer size: 16
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: decr, key: counter
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:1231 handle_incr_decr(): Handling DECR command for key='counter', value='1'
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:153 kv_get(): kv_get for key: [counter]
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:195 kv_get(): Got blob data: size=1
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:275 kv_get(): Successfully got key-value pair: [counter]=[3], flags=0, exptime=3
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 3 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 3 bytes, sent 3 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 3/3 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 3 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 392041 bytes from 127.0.0.1:58628, total buffer size: 392041
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: flush_all, key: 0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: DELETE FROM kv_store
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: set, key: large_key
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 409132 bytes from 127.0.0.1:58628, total buffer size: 801117
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 131072 bytes from 127.0.0.1:58628, total buffer size: 932189
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 116389 bytes from 127.0.0.1:58628, total buffer size: 1048578
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 15 bytes from 127.0.0.1:58628, total buffer size: 15
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: get, key: large_key
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:153 kv_get(): kv_get for key: [large_key]
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:195 kv_get(): Got blob data: size=1048576
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:275 kv_get(): Successfully got key-value pair: [large_key]=[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 27 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 27 bytes, sent 27 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 27/27 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 27 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 1048576 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 1048576 bytes, sent 327212 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 327212/1048576 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 721364 bytes, sent 49100 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 376312/1048576 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 672264 bytes, sent 130864 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 507176/1048576 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 541400 bytes, sent 32664 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 539840/1048576 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 508736 bytes, sent 139081 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 678921/1048576 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 369655 bytes, sent 0 bytes, err=-7
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:436 send_all(): Send error -7, retrying after 20ms (retry 1/5)
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 2: tried to send 369655 bytes, sent 369655 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 1048576/1048576 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 1048576 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 2 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 2 bytes, sent 2 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 2/2 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 2 bytes
[2025-02-09 14:17:35] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:542 handle_get(): Successfully sent key-value pair: [large_key]=[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 5 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 5 bytes, sent 5 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 5/5 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 5 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 21 bytes from 127.0.0.1:58628, total buffer size: 21
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: flush_all, key: 0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: DELETE FROM kv_store
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 106 bytes from 127.0.0.1:58628, total buffer size: 106
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: set, key: key1
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: set, key: key2
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: set, key: key3
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: get, key: key1
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:153 kv_get(): kv_get for key: [key1]
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:195 kv_get(): Got blob data: size=6
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:275 kv_get(): Successfully got key-value pair: [key1]=[value1], flags=0, exptime=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 16 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 16 bytes, sent 16 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 16/16 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 16 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 6 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 6 bytes, sent 6 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 6/6 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 6 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 2 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 2 bytes, sent 2 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 2/2 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 2 bytes
[2025-02-09 14:17:35] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:542 handle_get(): Successfully sent key-value pair: [key1]=[value1]
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 5 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 5 bytes, sent 5 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 5/5 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 5 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 10 bytes from 127.0.0.1:58628, total buffer size: 10
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: get, key: key2
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:153 kv_get(): kv_get for key: [key2]
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:195 kv_get(): Got blob data: size=6
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:275 kv_get(): Successfully got key-value pair: [key2]=[value2], flags=0, exptime=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 16 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 16 bytes, sent 16 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 16/16 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 16 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 6 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 6 bytes, sent 6 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 6/6 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 6 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 2 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 2 bytes, sent 2 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 2/2 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 2 bytes
[2025-02-09 14:17:35] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:542 handle_get(): Successfully sent key-value pair: [key2]=[value2]
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 5 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 5 bytes, sent 5 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 5/5 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 5 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:609 handle_request(): Received 10 bytes from 127.0.0.1:58628, total buffer size: 10
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:689 handle_request(): Processing command from 127.0.0.1:58628: get, key: key3
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:153 kv_get(): kv_get for key: [key3]
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:195 kv_get(): Got blob data: size=6
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:275 kv_get(): Successfully got key-value pair: [key3]=[value3], flags=0, exptime=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 16 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 16 bytes, sent 16 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 16/16 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 16 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 6 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 6 bytes, sent 6 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 6/6 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 6 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 2 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 2 bytes, sent 2 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 2/2 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 2 bytes
[2025-02-09 14:17:35] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:542 handle_get(): Successfully sent key-value pair: [key3]=[value3]
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:413 send_all(): Starting to send 5 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:419 send_all(): Send attempt 1: tried to send 5 bytes, sent 5 bytes, err=0
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:467 send_all(): Successfully sent 5/5 bytes
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:470 send_all(): Successfully sent all 5 bytes
[2025-02-09 14:17:35] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:600 handle_request(): Client 127.0.0.1:58628 closed connection
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: PRAGMA wal_checkpoint;
[2025-02-09 14:17:35] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
