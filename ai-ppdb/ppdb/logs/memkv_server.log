[2025-02-08 21:17:47] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:867 memkv_init(): Initializing MemKV service...
[2025-02-08 21:17:47] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:901 memkv_init(): MemKV service initialized successfully
[2025-02-08 21:17:47] DEBUG /Users/wjc/ai-ppdb/ppdb/src/ppdb/ppdb.c:669 parse_memkv_config(): Parsing config line: [127.0.0.1 11211 memkv  file::memory:?cache=shared]
[2025-02-08 21:17:47] DEBUG /Users/wjc/ai-ppdb/ppdb/src/ppdb/ppdb.c:729 parse_memkv_config(): Parsed values - host:[127.0.0.1] port:[11211] type:[memkv] backend:[file::memory:?cache=shared]
[2025-02-08 21:17:47] INFO /Users/wjc/ai-ppdb/ppdb/src/ppdb/ppdb.c:749 parse_memkv_config(): Added memkv service: 127.0.0.1:11211, backend: file::memory:?cache=shared
[2025-02-08 21:17:47] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:1079 memkv_apply_config(): Applying configuration...
[2025-02-08 21:17:47] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:1108 memkv_apply_config(): Applied configuration - host: 127.0.0.1, port: 11211, db_path: file::memory:?cache=shared
[2025-02-08 21:17:47] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:965 memkv_start(): Adding listener on 127.0.0.1:11211
[2025-02-08 21:17:47] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_poll.c:273 poly_poll_add_listener(): Added listener on 127.0.0.1:11211
[2025-02-08 21:17:48] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_poll.c:324 poly_poll_start(): New connection from 127.0.0.1:56709 on socket 0
[2025-02-08 21:17:48] WARN /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:809 handle_connection(): Failed to set TCP_KEEPIDLE
[2025-02-08 21:17:48] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:99 db_init(): Opening database: file::memory:?cache=shared
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: CREATE TABLE IF NOT EXISTS kv_store (  key TEXT PRIMARY KEY,  value BLOB,  flags INTEGER,  expiry INTEGER);CREATE INDEX IF NOT EXISTS idx_expiry ON kv_store(expiry);
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-08 21:17:48] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:134 db_init(): Database connection established
[2025-02-08 21:17:48] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:828 handle_connection(): New client connection from 127.0.0.1:56709
[2025-02-08 21:17:48] ERROR /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:579 handle_request(): Failed to receive data from 127.0.0.1:56709: -7
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:399 send_all(): Starting to send 5 bytes
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:405 send_all(): Send attempt 1: tried to send 5 bytes, sent 5 bytes, err=0
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:453 send_all(): Successfully sent 5/5 bytes
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:456 send_all(): Successfully sent all 5 bytes
[2025-02-08 21:17:48] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_poll.c:324 poly_poll_start(): New connection from 127.0.0.1:56710 on socket 0
[2025-02-08 21:17:48] WARN /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:809 handle_connection(): Failed to set TCP_KEEPIDLE
[2025-02-08 21:17:48] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:99 db_init(): Opening database: file::memory:?cache=shared
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: CREATE TABLE IF NOT EXISTS kv_store (  key TEXT PRIMARY KEY,  value BLOB,  flags INTEGER,  expiry INTEGER);CREATE INDEX IF NOT EXISTS idx_expiry ON kv_store(expiry);
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-08 21:17:48] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:134 db_init(): Database connection established
[2025-02-08 21:17:48] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:828 handle_connection(): New client connection from 127.0.0.1:56710
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:590 handle_request(): Received 391989 bytes from 127.0.0.1:56710, total buffer size: 391989
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:671 handle_request(): Processing command from 127.0.0.1:56710: flush_all, key: 0
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:282 sqlite_exec(): Executing SQL: DELETE FROM kv_store
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/poly/poly_db.c:292 sqlite_exec(): SQL execution successful
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:671 handle_request(): Processing command from 127.0.0.1:56710: set, key: large_key
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:590 handle_request(): Received 163320 bytes from 127.0.0.1:56710, total buffer size: 555253
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:590 handle_request(): Received 245812 bytes from 127.0.0.1:56710, total buffer size: 801065
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:590 handle_request(): Received 195984 bytes from 127.0.0.1:56710, total buffer size: 997049
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:590 handle_request(): Received 51529 bytes from 127.0.0.1:56710, total buffer size: 1048578
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:590 handle_request(): Received 15 bytes from 127.0.0.1:56710, total buffer size: 15
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:671 handle_request(): Processing command from 127.0.0.1:56710: get, key: large_key
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:146 kv_get(): kv_get for key: [large_key]
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:188 kv_get(): Got blob data: size=1048576
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:259 kv_get(): Successfully got key-value pair: [large_key]=[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:399 send_all(): Starting to send 27 bytes
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:405 send_all(): Send attempt 1: tried to send 27 bytes, sent 27 bytes, err=0
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:453 send_all(): Successfully sent 27/27 bytes
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:456 send_all(): Successfully sent all 27 bytes
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:399 send_all(): Starting to send 1048576 bytes
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:405 send_all(): Send attempt 1: tried to send 1048576 bytes, sent 327185 bytes, err=0
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:453 send_all(): Successfully sent 327185/1048576 bytes
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:405 send_all(): Send attempt 1: tried to send 721391 bytes, sent 0 bytes, err=-7
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:422 send_all(): Send error -7, retrying after 20ms (retry 1/5)
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:405 send_all(): Send attempt 2: tried to send 721391 bytes, sent 721391 bytes, err=0
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:453 send_all(): Successfully sent 1048576/1048576 bytes
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:456 send_all(): Successfully sent all 1048576 bytes
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:399 send_all(): Starting to send 2 bytes
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:405 send_all(): Send attempt 1: tried to send 2 bytes, sent 2 bytes, err=0
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:453 send_all(): Successfully sent 2/2 bytes
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:456 send_all(): Successfully sent all 2 bytes
[2025-02-08 21:17:48] INFO /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:524 handle_get(): Successfully sent key-value pair: [large_key]=[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:399 send_all(): Starting to send 5 bytes
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:405 send_all(): Send attempt 1: tried to send 5 bytes, sent 5 bytes, err=0
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:453 send_all(): Successfully sent 5/5 bytes
[2025-02-08 21:17:48] DEBUG /Users/wjc/ai-ppdb/ppdb/src/internal/peer/peer_memkv.c:456 send_all(): Successfully sent all 5 bytes
